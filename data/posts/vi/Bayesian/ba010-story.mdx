---
title: 'BA01. [Bayesian Data Noir] Công xưởng tĩnh lặng, Mỹ học Bayes khắc họa sự thật'
date: '2025-12-19'
tags: ['MCMC', 'Bayesian', 'Data Noir']
draft: false
summary: 'BA01. [Bayesian Data Noir] Công xưởng tĩnh lặng, Mỹ học Bayes khắc họa sự thật'
images: ['/static/images/ba01_cover.png']
authors: ['default']
---

## Ranh giới giữa Trực giác và Dữ liệu: Sự cố Short Shot tại nhà máy ép phun

Máy móc không nói dối. Chúng chỉ im lặng mà thôi.

Nhà máy giống như bụng của một con quái vật khổng lồ. _Thump-hiss, thump-hiss._ Tiếng nhịp tim đều đặn của những chiếc máy ép phun hàng trăm tấn làm rung chuyển mặt sàn. Âm thanh này chính là nhịp đập của nhà máy. Nhưng hôm nay, nhịp điệu đó có chút gì đó không ổn.

Trưởng ban kiểm tra chạy đến với bộ quần áo bảo hộ sũng mồ hôi. Trên tay ông là một chiếc vỏ nhựa định hình không hoàn chỉnh, hay còn gọi là lỗi ‘Short Shot’ (lỗi thiếu liệu).

"Từ sáng đến giờ có gì đó không ổn. Phần cuối không được điền đầy. Không biết đây là lần thứ bao nhiêu rồi."

'Short Shot'. Lỗi sản phẩm không thành hình hoàn chỉnh do nhựa nóng chảy bị đông cứng trước khi đi tới cuối khuôn. Các kỹ sư tại hiện trường gọi lỗi này là 'bóng ma' vì nguyên nhân của nó quá đa dạng.

Quản đốc tháo đôi găng tay dính đầy dầu mỡ và hỏi: "Nhiệt độ trục vít (barrel) thấp quá hay là áp suất phun bị thiếu? Có nên tháo bộ gia nhiệt (heater) ra kiểm tra không?"

Tại hiện trường, các quyết định thường được đưa ra dựa trên 'Cảm tính' (Gut Feeling). "Trời lạnh thế này chắc là do nhiệt độ rồi." Và nếu cảm tính đó sai, hàng triệu won chi phí sửa khuôn sẽ tan thành mây khói.

Tôi lắc đầu. "Chưa đâu, vẫn chưa thể chắc chắn. Hãy kiểm tra thêm một chút nữa."

Tôi cầm lấy cuốn sổ tay trống. Tôi rút ra vũ khí của mình: "Suy luận Bayes (Bayesian Inference)". Toán học Bayes là quá trình tìm kiếm sự thật nóng hổi thông qua những dữ liệu lạnh lùng, đó là hồ sơ của "Cập nhật Bayesian (Bayesian Update)".

Tôi quyết định trở thành một thám tử (Detective) đuổi theo kẻ nghi phạm để tìm ra thủ phạm. Thủ phạm đang ở trong nhà máy. Trong đầu tôi lập tức hiện ra hai nghi phạm (Suspect).

Nghi phạm (Suspect)

- Nghi phạm A: Nhiệt độ (_H
  T
  _)

- Tính cách: Thất thường. Nếu nhiệt độ trục vít thấp hoặc xảy ra hiện tượng dao động (hunting), nhựa sẽ bị đông cứng và không thể chảy đến tận cùng. Gây ra lỗi short shot không ổn định.

- Đặc điểm: Nếu tên này là thủ phạm, tỷ lệ lỗi sẽ vọt lên tới 8% (p = 0.08).

- Nghi phạm B: Áp suất (_H
  P
  _)

- Tính cách: Nhút nhát và thiếu lực. Tên này có áp suất giữ (holding pressure) yếu nên thỉnh thoảng không thể đẩy nhựa vào đến tận cùng.

- Đặc điểm: Tên này tương đối hiền lành, tỷ lệ lỗi chỉ khoảng 4% (p = 0.04).

.

## Trực giác kinh nghiệm, Nghi ngờ và Kiến thức tiên nghiệm (Prior: Xác suất tiên nghiệm).

Thủ phạm là một trong hai. Nhưng không thể tùy tiện dừng máy và tháo bộ gia nhiệt. Nhìn vào hồ sơ quý trước của hệ thống MES (Hệ thống quản lý sản xuất), 60% các vụ tai nạn short shot là do tên 'Nhiệt độ' gây ra.

"Xem lại hồ sơ tiền án, lần này khả năng cao vẫn là tên Nhiệt độ."

Niềm tin tiên nghiệm (Prior Belief) trong đầu tôi đã được thiết lập. Tôi bắt đầu ghi chép các dữ liệu vào sổ.

- Xác suất tiên nghiệm (Prior)

- Xác suất do Nhiệt độ $P(H_T)$ : 60% (Nghi phạm chính)

- Xác suất do Áp suất $P(H_P)$ : 40%

Các chuyên gia thường thích dùng Odds (Tỷ lệ cược/Số thắng thua) hơn là xác suất.

$$
\text{Prior Odds} = \frac{0.6}{0.4} = \mathbf{1.5}
$$

(Giải thích: Hiện tại, tôi đang đặt cược vào việc Nhiệt độ là thủ phạm cao gấp 1.5 lần so với Áp suất.)

.

## Bằng chứng đầu tiên: Cuộc tập kích buổi sáng (Update 1).

"Quản đốc, chúng ta hãy kiểm tra ngẫu nhiên 50 mẫu vừa mới sản xuất xong."

10 giờ sáng, những bằng chứng đầu tiên ($D_1$) được đổ lên bàn. Trong số 50 mẫu, có 5 mẫu bị lỗi short shot. (n = 50, k = 5)

"5 trên 50... Tỷ lệ lỗi 10%?"

Trong khoảnh khắc, tôi cảm thấy lạnh sống lưng. Nếu là vấn đề áp suất (p = 0.04), trong 50 mẫu cùng lắm chỉ có 2 mẫu lỗi là bình thường. 5 mẫu là quá nhiều so với phong cách của tên đó. Ngược lại, nó rất gần với 'Dấu ấn' (Signature) của tên Nhiệt độ hung bạo (tỷ lệ lỗi 8%).

Tại đây, vũ khí cốt lõi của Bayes là Likelihood (Khả năng xảy ra) xuất hiện. "Ai phải là thủ phạm thì bằng chứng này (5/50) mới trở nên hợp lý hơn?"

Tôi nhanh chóng tính toán Nhân tố Bayes (Bayes Factor), tức là 'Trọng lượng của bằng chứng'.

$$
\text{Bayes Factor} = \frac{P(D|H_T)}{P(D|H_P)}
$$

$$
\approx \left(\frac{0.08}{0.04}\right)^5 \times \left(\frac{0.92}{0.96}\right)^{45}
$$

$$
= 2^5 \times (0.9583)^{45}
$$

$$
= 32 \times 0.147
$$

$$
\approx \mathbf{4.7}
$$

4.7 lần.

Dữ liệu này (5 lỗi trong 50 mẫu) ủng hộ giả thuyết Nhiệt độ mạnh gấp 4.7 lần so với giả thuyết áp suất.

Bây giờ tôi phải cập nhật (Update) niềm tin của mình. Lấy [Niềm tin ban đầu (1.5)] nhân với [Sức mạnh của bằng chứng (4.7)].

.

## Cập nhật Bayes (Posterior 1): Sự bùng nổ của niềm tin.

Odds cũ (1.5) được kết hợp với bằng chứng (4.7).

$$
\text{New Odds} = 1.5 \times 4.7 = \mathbf{7.05}
$$

Quy đổi sang xác suất:

$$
P(H_T|D_1) = \frac{7.05}{1+7.05} \approx \mathbf{87.6\%}
$$

Niềm tin mới: Xác suất Nhiệt độ là thủ phạm đã vọt từ 60% lên 87.6%. Dữ liệu đang gào thét rằng: "Thủ phạm chính là Nhiệt độ!"

"Xác suất lỗi do bộ gia nhiệt lên tới gần 90%! Quản đốc, cho đội bảo trì chuẩn bị. Chúng ta sẽ kiểm tra nhiệt độ trục vít!" Giọng tôi đầy tự tin. Chìm đắm trong cảm giác chiến thắng, tôi nhấp một ngụm cà phê.

.

## Bằng chứng thứ hai: Sự phản công của Bayes (Update 2).

Điểm nhấn của kịch bản này bắt đầu từ đây. Nhiều người lầm tưởng Bayes là 'tính toán một lần là xong'. Nhưng sức mạnh thực sự của Bayes nằm ở Vòng lặp cập nhật (Update Loop).

2 giờ chiều. Ngay trước khi đội bảo trì đến, quản đốc mang mẫu thứ hai (D
2
) đến với vẻ mặt kỳ lạ. "Sau khi ăn trưa xong tôi đã lấy thêm 50 mẫu nữa... lạ lắm."

[Tổng cộng 50 mẫu, chỉ có 1 mẫu lỗi]

"Cái gì? Chỉ có 1 thôi sao?" Tôi nghe thấy tiếng nứt vỡ trong sự tự tin của mình. Nếu thủ phạm thực sự là tên Nhiệt độ (thường là 8%) hung hãn, thì 1 trên 50 (2%) là quá ít. Thay vào đó, đây là việc mà tên Áp suất (thường là 4%) hiền lành có thể gây ra.

Dữ liệu đang lên tiếng: "Thủ phạm có thể không phải là Nhiệt độ!"

Và thế là, phép màu của suy luận Bayes bắt đầu. Sự tự tin 87.6% (Posterior) mà tôi có lúc nãy không hề biến mất. Nó trở thành Điểm khởi đầu mới (New Prior) cho cuộc suy luận buổi chiều.

[Kết luận buổi sáng = Khởi đầu buổi chiều] Đây chính là cách mà trí tuệ nhân tạo, và cả chúng ta, học hỏi thế giới. Tôi bắt đầu tính toán lại. Bằng cách cập nhật kết quả tính toán buổi sáng (xác suất hậu nghiệm) làm xác suất tiên nghiệm cho lần tính toán này, tôi kiểm chứng khả năng minh chứng của dữ liệu (D
2
).

$$
\text{Bayes Factor}_2 \approx \left(\frac{0.08}{0.04}\right)^1 \times \left(\frac{0.92}{0.96}\right)^{49}
$$

$$
= 2 \times 0.122
$$

$$
\approx \mathbf{0.244}
$$

Giá trị nhỏ hơn 1 rất nhiều. Điều này có nghĩa là "Bằng chứng bất lợi cho giả thuyết Nhiệt độ". Chính xác mà nói, bằng chứng thứ hai ủng hộ giả thuyết áp suất gấp khoảng 4 lần. Một sự phản chứng mạnh mẽ. Tôi nghe thấy sự tự tin buổi sáng của mình đang sụp đổ.

.

## Cập nhật Bayes lần 2 (Posterior 2): Sự phán xét của Bayes, niềm tin trở nên khiêm tốn.

Bây giờ, nhân 'Niềm tin buổi sáng (Odds 7.05)' với 'Cú xoay chuyển buổi chiều (0.244)'.

$$
\text{Final Odds} = 7.05 \times 0.244 \approx \mathbf{1.72}
$$

Quy đổi sang xác suất:

$$
P(H_T | D_1, D_2) = \frac{1.72}{1+1.72} \approx \mathbf{63.2\%}
$$

.

## Sự thật sẽ hội tụ.

.

Biểu đồ xác suất trong đầu tôi dao động dữ dội. Tôi vội vàng dừng việc gọi đội bảo trì.

"Khoan đã, đợi chút. Đừng tháo bộ gia nhiệt vội."

Tôi lau mồ hôi và tựa lưng vào ghế. Buổi sáng tôi tin chắc 87%, nhưng giờ đã giảm xuống còn 64%. Tuy vẫn còn nghi ngờ Nhiệt độ, nhưng khả năng là 'Áp suất' cũng đã sống lại tới 36%. Nếu lúc nãy tôi phấn khích tháo bộ gia nhiệt, có lẽ tôi đã thay thế một bộ gia nhiệt hoàn toàn bình thường và bỏ lỡ vấn đề áp suất vốn là nguyên nhân thực sự. Nhà máy sẽ mất đi thời gian quan trọng nhất và tốn tiền vô ích.

"Quản đốc, hãy lấy thêm 50 mẫu nữa từ lô (Lot) tiếp theo. Chỉ cần thêm một dữ liệu nữa thôi... chúng ta có thể bắt được thủ phạm một cách chắc chắn."

Khi dữ liệu tích lũy, sương mù sẽ tan biến và sự thật sẽ lộ diện. Sự thật hội tụ khi dữ liệu được tích lũy. Đó là cách mà Bayes đã dạy chúng ta.

Tôi lại lắng nghe nhịp đập của máy móc. Chúng tôi không vội vàng hét lên "Thủ phạm là anh!". Chúng tôi chỉ không ngừng quan sát dữ liệu đổ về và cập nhật theo 'xác suất gần với sự thật nhất'.

.

## Thông điệp cốt lõi (Insight) của kịch bản này

- Số hóa trực giác: Khoảnh khắc bạn chuyển cảm tính "Hình như là do nhiệt độ?" thành con số P(H)=0.6, việc quản lý trở nên khả thi. Con số 0.6 không nhất thiết phải là sự thật tại thời điểm đó. Khi dữ liệu tích lũy và liên tục được cập nhật, mô hình sẽ tự học hỏi. Bởi vì cuối cùng, nó sẽ hội tụ về sự thật.

- Trọng lượng của dữ liệu (LLR): 5/50 lỗi là một bằng chứng mạnh mẽ (+1.55), nhưng kết quả tốt 1/50 lần thứ hai là một sự phản chứng mạnh mẽ tương đương (-1.39) để tạo ra sự cân bằng.

- Ra quyết định động: Quan điểm Bayesian không phải là một kết luận cố định. Thái độ khiêm tốn và linh hoạt kiểu "Với những thông tin cho đến nay, tôi biết đến mức này" sẽ cứu các kỹ sư khỏi những sai lầm.

.

## [Hướng dẫn] [Giải thích toán học](https://news.exavions.com/ko/ba01-the-short-shot-math/), Phụ lục mã Python

Trong vở kịch điều tra kịch tính này, chúng ta đã trải nghiệm 4 bước cốt lõi của thống kê Bayesian.

- Xác suất tiên nghiệm (Prior): _"Nhìn vào quá khứ, có vẻ hắn là thủ phạm?"_ (Niềm tin ban đầu)

- Likelihood (Khả năng xảy ra): _"Bằng chứng hiện trường hoàn toàn khớp với phong cách của hắn!"_ (Sự phù hợp của bằng chứng)

- Nhân tố Bayes (Bayes Factor): _"Bằng chứng này ủng hộ A gấp bao nhiêu lần so với B?"_ (Trọng lượng của bằng chứng)

- Xác suất hậu nghiệm (Posterior): _"Hãy sửa đổi niềm tin của mình dựa trên bằng chứng."_ (Kết luận cuối cùng)

Và điều quan trọng nhất: Xác suất hậu nghiệm của hôm nay sẽ trở thành xác suất tiên nghiệm của ngày mai. Đây chính là bản chất của việc học (Learning).

- Toán học: Câu chuyện này không đơn thuần là một tình tiết hư cấu. Nó là một tòa thành được xây dựng trên những tính toán toán học chặt chẽ. Cách thức 'Định lý Bayes truyền thống' học trong sách giáo khoa được chuyển đổi thành 'Odds và Nhân tố Bayes' dùng trong thực tế sẽ được tiết lộ trong một bài viết phụ lục riêng biệt.

- Mã Python: Bạn có thể tham khảo một bài viết phụ lục khác, nơi kịch bản trong bài viết này được chuyển đổi trực tiếp thành mã Python.
