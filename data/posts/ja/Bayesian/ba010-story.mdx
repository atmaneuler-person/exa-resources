---
title: 'BA01. [Bayesian Data Noir] 沈黙の工場、真実を刻むベイズの美学'
date: '2025-12-19'
tags: ['Bayesian', 'likelihood', 'Odds']
draft: false
summary: 'BA01. [Bayesian Data Noir] 沈黙の工場、真実を刻むベイズの美学'
images: ["/static/images/ba01_cover.png"]
authors: ["default"]
---

 

## 直感とデータの境界線で： 射出成形工場のショートショット事件

機械は嘘をつかない。ただ沈黙するのみ。

工場は巨大な獣の腹の中のようだ。*クン、シュー。クン、シュー。* 数百トンの射出成形機の規則的な鼓動が床を揺らす。この音は工場の心拍だ。しかし今日、そのリズムは微妙に狂っていた。

検査班長が汗に濡れた作業服姿で駆け寄ってきた。彼の親には不完全に成形されたプラスチックケース、通称「ショートショット（Short Shot）」の不良品が握られていた。

「朝から様子がおかしいんです。端まで充填されません。もう何度目か分かりません。」

「ショートショット（Short Shot）」。溶融したプラスチックが金型の端まで到達せずに固まってしまう未充填不良。現場のエンジニアたちは、この不良を「幽霊」と呼ぶ。原因があまりに多様だからだ。

作業班長が油の付いた手袋を脱ぎながら尋ねる。「バレルの温度が低いんですか、それとも射出圧力が足りないんですか？ ヒーターからバラしましょうか？」

現場では普通、「勘（Gut Feeling）」で決定する。「寒いから温度の問題だろう。」そしてその勘が外れれば、数百万ウォンの金型修正費用が露と消える。

私は首を振った。「いいえ、まだです。まだ確実ではありません。もう少し確認しましょう。」

私は空白のノートを手に取った。私の武器である「ベイズ推論（Bayesian Inference）」を取り出したのだ。ベイズ数学は、冷徹なデータを通じて熱い真実を探し求める過程、すなわち「ベイズ更新（Bayesian Update）」の記録である。

私はしばらく、容疑者を追って犯人を見つけ出す刑事（Detective）になることにした。犯人は工場の中にいる。私の頭の中には即座に2人の容疑者（Suspect）が浮かんだ。

容疑者（Suspect）

- 容疑者A：温度（*H
T
*）

- 性格：気まぐれ。バレルの温度が低かったり、ハンチング（hunting）が生じると樹脂が固まってしまい、最後まで流れない。不安定なショートショット不良を引き起こす。

- 特異点：こいつが犯人なら、不良率は8%（p = 0.08）まで跳ね上がる。

- 容疑者B：圧力（*H
P
*）

- 性格：消極的で力が不足している。こいつは保圧が弱く、時々最後まで押し込めないという問題がある。

- 特異点：こいつなら比較的おとなしく、不良率は4%（p = 0.04）程度だ。

.

## 経験的な直感と疑い、事前知識（Prior：事前確率）

犯人はどちらかだ。しかし、むやみに機械を止めてヒーターを調べるわけにはいかない。MES（生産管理システム）の前期の記録を見ると、ショートショット事故の60%は「温度」の仕業だった。

「過去の犯行記録を見ると、今回も温度の確率が高そうだな。」

私の中の事前の信じ込み（Prior Belief）がセットされる。私はデータをノートに記録し始めた。

- 事前確率（Prior）

- 温度である確率 P(H
T
) : 60%（有力容疑者）

- 圧力である確率 P(H
P
) : 40%

プロは確率よりもオッズ（Odds、勝算）を好んで使う。

$$
\text{Prior Odds} = \frac{0.6}{0.4} = \mathbf{1.5}
$$

（解釈：現在、私は温度が犯人であるという方に、圧力よりも1.5倍多く賭けている。）

.

## 最初の証拠：午前の襲撃（Update 1）

「作業班長、今生産されたものを50個だけ無作為に検査してみましょう。」

午前10時、最初の証拠品（D1）が机の上にぶちまけられた。50個のサンプルのうち、5個がショートショットだった。（n = 50, k = 5）

「50個中5個か…不良率10%？」

瞬間、背筋が凍った。圧力の問題（p = 0.04）なら、50個中せいぜい2個程度出るのが正常だ。こいつの仕業にしては過激すぎる。5個は多すぎる。むしろ、乱暴な温度（不良率8%）のシグネチャー（Signature）に近い。

ここでベイズの核心的な武器である尤度（Likelihood）が登場する。「誰が犯人であれば、この証拠（5/50）がより理にかなうか？」

私は素早くベイズ因子（Bayes Factor）、すなわち「証拠の重み」を計算した。

$$
\text{Bayes Factor} = \frac{P(D|H_T)}{P(D|H_P)}
$$

$$
\approx \left(\frac{0.08}{0.04}\right)^5 \times \left(\frac{0.92}{0.96}\right)^{45}
$$

$$
= 2^5 \times (0.9583)^{45}
$$

$$
= 32 \times 0.147
$$

$$
\approx \mathbf{4.7}
$$

4.7倍。

このデータ（50個中5個の不良）は、圧力よりも温度仮説を4.7倍も強力に支持している。

今、私は自分の信念を更新（Update）しなければならない。［元の信念（1.5）］に［証拠の力（4.7）］を掛ける。

.

## ベイズ更新（Posterior 1）：確信の急上昇

既存のオッズ（1.5）に証拠（4.7）が結合される。

$$
\text{New Odds} = 1.5 \times 4.7 = \mathbf{7.05}
$$

これを確率に換算すると：

$$
P(H_T|D_1) = \frac{7.05}{1+7.05} \approx \mathbf{87.6\%}
$$

新たな確信：温度が犯人である確率が60% → 87.6%に急騰した。データが「犯人は温度だ！」と悲鳴を上げている。

「ヒーター側の問題である確率が90%近くになります！ 作業班長、整備チームを待機させてください。バレルの温度チェックに入ります！」私の声は確信に満ちていた。勝利感に酔いしれながらコーヒーを一口飲んだ。

.

## 2つ目の証拠：ベイズの反撃（Update 2）

このシナリオのハイライトはこれからだ。多くの人がベイズを「一度計算して終わり」だと思い込んでいる。しかし、ベイズの真の力は累積（Update Loop）にある。

午後2時。整備チームが到着する直前、作業班長が妙な表情で2次サンプル（D
2
）を持ってきた。「昼食後に50個追加で出してみたんですが…変なんです。」

［計50個中、不良1個発生］

「何？ 1個だと？」私の確信にヒビが入る音がした。もし本当の犯人が乱暴な温度（普段は8%）なら、50個中1個（2%）は少なすぎる。むしろこれは、おとなしい圧力（普段は4%）がしでかしそうなことだ。

データが叫んでいる。「犯人は温度ではないかもしれない！」

さあ、ここでベイズ推論の魔法が始まる。先ほど私が抱いた87.6%の確信（Posterior）。それは消えるのではない。それは午後の推論のための新たな出発点（New Prior）となる。

［午前の結論 ＝ 午後の始まり］ これが人工知能、そして私たちが世界を学ぶ方法だ。私は再び計算を始めた。午前の計算結果（事後確率）を今回の計算の事前確率としてアップデートし、データ（D
2
）の証拠能力を検証する。

$$
\text{Bayes Factor}_2 \approx \left(\frac{0.08}{0.04}\right)^1 \times \left(\frac{0.92}{0.96}\right)^{49}
$$

$$
= 2 \times 0.122
$$

$$
\approx \mathbf{0.244}
$$

値が1よりはるかに小さい。これは「温度仮説に不利な証拠」という意味だ。正確に言えば、2つ目の証拠は圧力仮説を4倍ほど強く支持している。凄まじい反証だ。午前の確信が崩れる音がした。

.

## ベイズ2次更新（Posterior 2）：ベイズの審判、謙虚になる確信

「午前の確信（Odds 7.05）」に「午後の反転（0.244）」を掛ける。

$$
\text{Final Odds} = 7.05 \times 0.244 \approx \mathbf{1.72}
$$

確率に換算すると：

$$
P(H_T | D_1, D_2) = \frac{1.72}{1+1.72} \approx \mathbf{63.2\%}
$$

.

## 真実へ収束する

.

頭の中の確率グラフが激しく揺れ動いた。私は急いで整備チームの呼び出しを止めた。

「ちょっと待ってください。まだヒーターをバラさないでください。」

私は汗を拭いながら椅子にもたれかかった。午前は87%確信していたが、今は64%までガクンと落ちた。依然として温度が疑わしくはあるが、「圧力」である可能性も36%まで息を吹き返した。もし先ほど興奮してヒーターをバラしていたら、まともなヒーターだけを交換し、真の原因かもしれない圧力問題を見逃していただろう。工場は最も重要な時間を無駄にし、無駄金を使うところだった。

「作業班長、次のロットでサンプルをもう50個だけ取りましょう。データがあと一つあれば…確実に仕留められます。」

データが積み重なれば、霧は晴れ、真実が姿を現す。真実はデータが積み重なるほど収束する。それがベイズが私たちに教えてくれたやり方だ。

私は再び機械の鼓動に耳を澄ませた。私たちは安易に「犯人はお前だ！」とは叫ばない。ただ絶え間なく入ってくるデータを見つめ、「最も真実に近い確率」へとアップデートし続けるだけだ。

.

## このシナリオの核心的な Insight

- 直感の数値化：「温度の問題かな？」という勘を P(H)=0.6 という数字に変えた瞬間、管理が可能になります。0.6がその瞬間の真実でなくても構いません。データが蓄積され、更新され続けることで、モデル自らが学習します。最終的には真実へと収束していくからです。

- データの重み（LLR）： 5/50の不良は強力な証拠（+1.55）でしたが、2回目の1/50という良好な結果は、それと同じくらい強力な反証（-1.39）となり、バランスを保ちます。

- 動的意思決定： ベイジアンの視点は固定された結論ではありません。「今までの情報では、ここまで分かっている」という謙虚で柔軟な態度が、エンジニアをミスから救います。

.

## ［ガイド］ ［[数学解説集](https://news.exavions.com/ja/ba01-the-short-shot-%e6%95%b0%e5%ad%a6%e8%a7%a3%e8%aa%ac/)］、Pythonコード付録

この緊迫した捜査劇の中で、私たちはすでにベイズ統計の核心的な4つの段階を経験しました。

- 事前確率（Prior）：「過去を見ると、あいつが犯人っぽいが？」（初期の信念）

- 尤度（Likelihood）：「現場の証拠があいつのスタイルとピッタリだ！」（証拠の適合性）

- ベイズ因子（Bayes Factor）：「この証拠はAよりBを何倍支持しているか？」（証拠の重み）

- 事後確率（Posterior）：「証拠を反映して信念を修正しよう。」（最終結論）

そして最も重要なこと。「今日の事後確率は、明日の事前確率になる」。 これこそが学習（Learning）の本質です。

- 数学：この物語は単なるエピソードではありません。徹底した数学的計算の上に築かれた城です。教科書で学ぶ「伝統的なベイズの定理」が、現場で使われる「オズとベイズ因子」にどのように変換されるのか、その数学的設計図（Blueprint）を別冊の付録記事で公開します。

- Pythonコード：本文のシナリオをそのままPythonコード化した別の付録記事を参照することができます。
