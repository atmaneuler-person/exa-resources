---
title: 'BA01.[Bayesian Data Noir] Công xưởng tĩnh lặng, tính thẩm mỹ của Bayes trong việc đi tìm sự thật'
date: '2025-12-19'
images: ['/static/images/ba01_cover.png']
summary: "Số hóa lĩnh vực trực giác: Trường hợp ra quyết định động sử dụng cập nhật Bayesian. Trong một công trường sản xuất đầy rẫy những bất định, dữ liệu trở thành vũ khí ra quyết định như thế nào? Bài viết này trình bày sinh động trường hợp ứng dụng thực tế của thống kê Bayesian thông qua quá trình giải quyết lỗi 'short shot' tại nhà máy ép phun."
authors: ['default']
tags: ['Nhân tố Bayes', 'Cập nhật Bayesian', 'Tỷ lệ cược']
draft: false
---

## Trên ranh giới giữa trực giác và dữ liệu:

### Sự cố Short Shot tại nhà máy ép phun

### Máy móc không nói dối. Chúng chỉ im lặng

Nhà máy giống như bụng của một con thú khổng lồ. _Thình thịch - xì, thình thịch - xì._ Tiếng nhịp tim đều đặn của máy ép phun hàng trăm tấn làm rung chuyển mặt đất. Tiếng động này chính là nhịp tim của nhà máy. Nhưng hôm nay, nhịp điệu đó đã bị sai lệch một cách tinh vi.

Trưởng ca kiểm tra chạy đến với bộ quần áo bảo hộ đẫm mồ hôi. Trên tay ông là những vỏ nhựa được tạo hình không hoàn chỉnh, còn gọi là sản phẩm lỗi ‘short shot’.

"Từ sáng đến giờ có gì đó không ổn. Phần cuối không được lấp đầy. Tôi không biết đây là lần thứ mấy rồi."

'Short Shot'. Lỗi tạo hình không hoàn chỉnh khi nhựa nóng chảy không thể chạm tới cuối khuôn và bị đông cứng lại. Các kỹ sư tại hiện trường gọi lỗi này là 'linh hồn' vì nguyên nhân của nó quá đa dạng.

Trưởng ca tháo đôi găng tay dính đầy dầu mỡ và hỏi: "Nhiệt độ thùng (barrel) thấp hay áp suất phun bị thiếu? Chúng ta có nên tháo bộ gia nhiệt (heater) ra không?"

Tại hiện trường, các quyết định thường được đưa ra bằng 'cảm giác (Gut Feeling)'. "Trời lạnh nên chắc là do nhiệt độ thôi." Và nếu cảm giác đó sai, chi phí sửa chữa khuôn mẫu hàng triệu won sẽ tan thành mây khói.

Tôi lắc đầu. "Không, vẫn chưa. Tôi vẫn chưa chắc chắn. Hãy kiểm tra thêm một chút nữa."

Tôi cầm lấy cuốn sổ tay trống. Tôi rút ra vũ khí của mình, "Suy luận Bayesian (Bayesian Inference)". Toán học Bayesian là quá trình tìm kiếm sự thật nóng hổi thông qua các dữ liệu lạnh lùng, chính là bản ghi chép của "Cập nhật Bayesian (Bayesian Update)".

Tôi quyết định trở thành một thám tử (Detective) truy đuổi các nghi phạm để tìm ra thủ phạm. Thủ phạm đang ở trong nhà máy. Trong đầu tôi lập tức hiện lên hai nghi phạm (Suspect).

#### Nghi phạm (Suspect)

- **Nghi phạm A: Nhiệt độ ($H_T$)**
  - Tính cách: Thất thường. Nếu nhiệt độ thùng thấp hoặc xảy ra hiện tượng dao động (hunting), nhựa sẽ đông cứng và không thể chảy đến cuối. Gây ra lỗi short shot không ổn định.
  - Đặc điểm: Nếu tên này là thủ phạm, tỷ lệ lỗi sẽ vọt lên tới 8% ($p = 0.08$).

- **Nghi phạm B: Áp suất ($H_P$)**
  - Tính cách: Nhút nhát và thiếu sức mạnh. Tên này có áp suất giữ (holding pressure) yếu nên thỉnh thoảng gặp vấn đề không thể đẩy nhựa vào đến cuối.
  - Đặc điểm: Nếu là tên này, hắn tương đối hiền lành nên tỷ lệ lỗi chỉ khoảng 4% ($p = 0.04$).

#### Trực giác thực nghiệm, sự nghi ngờ và kiến thức tiên nghiệm (Prior: Xác suất tiên nghiệm)

Thủ phạm là một trong hai. Nhưng không thể tùy tiện dừng máy và tháo bộ gia nhiệt ra được. Nhìn vào hồ sơ quý trước của hệ thống MES (Hệ thống quản lý sản xuất), 60% các sự cố short shot là do tên 'Nhiệt độ' gây ra.

"Nhìn vào hồ sơ tiền án quá khứ, khả năng cao lần này cũng là tên Nhiệt độ."

Niềm tin tiên nghiệm (Prior Belief) trong đầu tôi đã được thiết lập. Tôi bắt đầu ghi chép các dữ liệu vào sổ tay.

- **Xác suất tiên nghiệm (Prior)**
  - Xác suất do nhiệt độ $P(H_T)$: 60% (Nghi phạm chính)
  - Xác suất do áp suất $P(H_P)$: 40%

Những người chuyên nghiệp thường thích sử dụng tỷ lệ cược (Odds) hơn là xác suất.

$$


\text{Prior Odds} = \frac{0.6}{0.4} = \mathbf{1.5}


$$

(Giải thích: Hiện tại, tôi đang đặt cược vào khả năng nhiệt độ là thủ phạm cao gấp 1.5 lần so với áp suất.)

#### Bằng chứng thứ nhất: Cuộc tấn công buổi sáng (Update 1)

"Trưởng ca, chúng ta hãy kiểm tra ngẫu nhiên 50 sản phẩm vừa được sản xuất."

Lúc 10 giờ sáng, vật chứng đầu tiên ($D_1$) đã đổ ra trên bàn. Trong số 50 mẫu, có 5 mẫu bị short shot. ($n = 50, k = 5$)

"5 trên 50... Tỷ lệ lỗi 10%?"

Trong khoảnh khắc, tôi cảm thấy lạnh sống lưng. Nếu là vấn đề áp suất ($p = 0.04$), thì trong 50 cái cùng lắm chỉ có 2 cái là bình thường. 5 cái là quá nhiều để coi là hành động của tên áp suất. Thay vào đó, nó gần với chữ ký (Signature) của tên Nhiệt độ hung bạo (tỷ lệ lỗi 8%).

Tại đây, vũ khí cốt lõi của Bayes là Khả năng (Likelihood) xuất hiện. "Ai phải là thủ phạm thì bằng chứng này (5/50) mới có lý hơn?"

Tôi nhanh chóng tính toán Nhân tố Bayes (Bayes Factor), tức là 'trọng số của bằng chứng'.

$$


\text{Bayes Factor} = \frac{P(D|H_T)}{P(D|H_P)}


$$

$$


\approx \left(\frac{0.08}{0.04}\right)^5 \times \left(\frac{0.92}{0.96}\right)^{45}


$$

$$


= 2^5 \times (0.9583)^{45}


$$

$$


= 32 \times 0.147


$$

$$


\approx \mathbf{4.7}


$$

4.7 lần.

Dữ liệu này (5 trên 50 sản phẩm lỗi) ủng hộ giả thuyết nhiệt độ mạnh hơn gấp 4.7 lần so với áp suất.

Bây giờ tôi phải cập nhật (Update) niềm tin của mình. Nhân [niềm tin ban đầu (1.5)] với [sức mạnh của bằng chứng (4.7)].

## Cập nhật Bayes (Posterior 1): Sự xác tín tăng vọt.

Tỷ lệ cược cũ (1.5) được kết hợp với bằng chứng (4.7).

$$


\text{New Odds} = 1.5 \times 4.7 = \mathbf{7.05}


$$

Quy đổi sang xác suất:

$$


P(H_T|D_1) = \frac{7.05}{1+7.05} \approx \mathbf{87.6\%}


$$

Xác tín mới: Xác suất nhiệt độ là thủ phạm đã vọt từ 60% lên 87.6%. Dữ liệu đang hét lên rằng "Thủ phạm là nhiệt độ!".

"Xác suất vấn đề nằm ở bộ gia nhiệt lên tới gần 90%! Trưởng ca, hãy cho đội bảo trì chờ sẵn. Chúng ta sẽ kiểm tra nhiệt độ thùng!" Giọng tôi đầy sự quyết đoán. Tôi nhấp một ngụm cà phê trong cảm giác chiến thắng.

## Bằng chứng thứ hai: Bayes phản công (Update 2).

Điểm nhấn của kịch bản này bắt đầu từ đây. Nhiều người lầm tưởng Bayes là 'tính toán một lần là xong'. Nhưng sức mạnh thực sự của Bayes nằm ở sự tích lũy (Update Loop).

2 giờ chiều. Ngay trước khi đội bảo trì đến, trưởng ca mang theo mẫu thứ hai ($D_2$) với vẻ mặt kỳ lạ. "Sau khi ăn trưa, tôi đã lấy thêm 50 mẫu nữa... Có gì đó lạ lắm."

[Trong tổng số 50 mẫu, phát sinh 1 lỗi]

"Cái gì? 1 lỗi sao?" Tôi nghe thấy tiếng rạn nứt trong sự xác tín của mình. Nếu thủ phạm thực sự là tên Nhiệt độ hung bạo (thông thường 8%), thì 1 trên 50 (2%) là quá ít. Thay vào đó, đây là việc mà tên Áp suất hiền lành (thông thường 4%) có khả năng làm hơn.

Dữ liệu đang hét lên: "Thủ phạm có thể không phải là nhiệt độ!"

Và thế là, ma thuật của suy luận Bayesian bắt đầu. Sự xác tín 87.6% mà tôi có lúc nãy (Posterior) không hề biến mất. Nó trở thành điểm khởi đầu mới (New Prior) cho suy luận buổi chiều.

[Kết luận buổi sáng = Bắt đầu buổi chiều] Đây là cách mà trí tuệ nhân tạo, và cả chúng ta, học về thế giới. Tôi bắt đầu tính toán lại. Tôi cập nhật kết quả tính toán buổi sáng (xác suất hậu nghiệm) thành xác suất tiên nghiệm cho lần tính toán này để kiểm chứng năng lực bằng chứng của dữ liệu ($D_2$).

$$


\text{Bayes Factor}_2 \approx \left(\frac{0.08}{0.04}\right)^1 \times \left(\frac{0.92}{0.96}\right)^{49}


$$

$$


= 2 \times 0.122


$$

$$


\approx \mathbf{0.244}


$$

Giá trị nhỏ hơn 1 rất nhiều. Điều này có nghĩa là "Bằng chứng bất lợi cho giả thuyết nhiệt độ". Nói chính xác hơn, bằng chứng thứ hai ủng hộ giả thuyết áp suất mạnh hơn gấp 4 lần. Một sự phản chứng khủng khiếp. Tôi nghe thấy tiếng đổ vỡ của sự xác tín buổi sáng.

## Cập nhật Bayes lần 2 (Posterior 2): Sự phán xét của Bayes, niềm tin trở nên khiêm tốn.

Bây giờ nhân 'sự xác tín buổi sáng (Odds 7.05)' với 'sự đảo ngược buổi chiều (0.244)'.

$$


\text{Final Odds} = 7.05 \times 0.244 \approx \mathbf{1.72}


$$

Quy đổi sang xác suất:

$$


P(H_T | D_1, D_2) = \frac{1.72}{1+1.72} \approx \mathbf{63.2\%}


$$

## Sự thật sẽ hội tụ.

Biểu đồ xác suất trong đầu tôi dao động dữ dội. Tôi vội vàng dừng việc gọi đội bảo trì.

"Đợi đã, hãy chờ một chút. Đừng tháo bộ gia nhiệt vội."

Tôi lau mồ hôi và tựa vào ghế. Buổi sáng tôi chắc chắn 87%, nhưng giờ nó đã rơi xuống còn 63%. Mặc dù vẫn nghi ngờ nhiệt độ, nhưng khả năng là 'áp suất' cũng đã sống lại tới 36%. Nếu lúc nãy tôi phấn khích mà tháo bộ gia nhiệt ra, tôi sẽ chỉ thay thế một bộ gia nhiệt đang hoạt động tốt và bỏ lỡ vấn đề áp suất có thể là nguyên nhân thực sự. Nhà máy suýt chút nữa đã lãng phí thời gian quan trọng nhất và cả tiền bạc.

"Trưởng ca, hãy lấy thêm 50 mẫu nữa từ lô tiếp theo. Nếu có thêm một dữ liệu nữa... chúng ta có thể bắt được hắn một cách chắc chắn."

Khi dữ liệu tích lũy, màn sương sẽ tan biến và sự thật sẽ lộ diện. Sự thật sẽ hội tụ khi dữ liệu càng nhiều. Đó là cách mà Bayes đã dạy chúng ta.

Tôi lại lắng nghe nhịp đập của máy móc. Chúng tôi không vội vàng hét lên "Thủ phạm là ngươi!". Chúng tôi chỉ không ngừng quan sát dữ liệu đi vào và cập nhật thành 'xác suất gần với sự thật nhất'.

## Insight cốt lõi của kịch bản này

- **Số hóa trực giác**: Khoảnh khắc bạn thay đổi cảm giác "Hình như là vấn đề nhiệt độ?" thành con số $P(H)=0.6$, việc quản lý trở nên khả thi. 0.6 không cần phải là sự thật tại thời điểm đó. Khi dữ liệu tích lũy và tiếp tục cập nhật, mô hình sẽ tự học. Bởi vì cuối cùng nó sẽ hội tụ về sự thật.
- **Trọng số của dữ liệu (LLR)**: 5/50 lỗi là bằng chứng mạnh mẽ (+1.55), nhưng kết quả tốt 1/50 lần thứ hai trở thành sự phản chứng mạnh mẽ tương đương (-1.39) để tạo ra sự cân bằng.
- **Ra quyết định động**: Quan điểm Bayesian không phải là một kết luận cố định. Thái độ khiêm tốn và linh hoạt "Với thông tin cho đến nay, tôi biết đến đây" sẽ cứu các kỹ sư khỏi những sai lầm.

## [Hướng dẫn] [Tập giải thích toán học](https://news.exavions.com/ko/ba01-the-short-shot-math/), Phụ lục mã Python

Trong vở kịch điều tra căng thẳng này, chúng ta đã trải nghiệm 4 giai đoạn cốt lõi của thống kê Bayesian.

- **Xác suất tiên nghiệm (Prior)**: _"Nhìn vào quá khứ thì có vẻ tên đó là thủ phạm?"_ (Niềm tin ban đầu)
- **Khả năng (Likelihood)**: _"Bằng chứng hiện trường khớp hoàn toàn với phong cách của hắn!"_ (Sự phù hợp của bằng chứng)
- **Nhân tố Bayes (Bayes Factor)**: _"Bằng chứng này ủng hộ A gấp bao nhiêu lần so với B?"_ (Trọng số của bằng chứng)
- **Xác suất hậu nghiệm (Posterior)**: _"Hãy sửa đổi niềm tin của tôi bằng cách phản ánh bằng chứng."_ (Kết luận cuối cùng)

Và điều quan trọng nhất. Xác suất hậu nghiệm của ngày hôm nay trở thành xác suất tiên nghiệm của ngày mai. Đây chính là bản chất của việc học (Learning).

- **Toán học**: Câu chuyện này không đơn thuần là một tình tiết. Nó là một tòa lâu đài được xây dựng trên các tính toán toán học chặt chẽ. Cách thức 'Định lý Bayes truyền thống' học trong sách giáo khoa được chuyển đổi thành 'Tỷ lệ cược và Nhân tố Bayes' sử dụng tại hiện trường như thế nào, bản thiết kế toán học (Blueprint) đó sẽ được tiết lộ trong một bài viết phụ lục riêng.
- **Mã Python**: Bạn có thể tham khảo một bài viết phụ lục khác đã chuyển đổi kịch bản của văn bản thành mã Python.
