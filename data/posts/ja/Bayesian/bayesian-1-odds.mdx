---
title: 'BA01. [Bayesian Data Noir] 沈黙の工場、真実を刻むベイズの美学'
date: '2026-02-03'
images: ['/static/images/ba01_cover.png']
summary: '直感の領域を数値化する：ベイズ更新（Bayesian Update）を活用した動的な意思決定の事例。不確実性が支配する製造現場で、データはいかにして意思決定の武器となるのか？本記事では、射出成形工場の「ショートショット（Short Shot）」不良解決の過程を通じて、ベイズ統計の実際の適用事例を鮮明に描き出します。'
authors: ['default']
tags: ['MCMC', 'Inference', 'Math']
draft: false
---

# 直感とデータの境界線で：射出工場のショートショット事件

## 機械は嘘をつかない。ただ沈黙するだけだ

工場は巨大な獣の腹の中のようだ。クン、シュー、クン、シュー。数百トンの射出機の規則的な鼓動が床を揺らす。この音は工場の心拍だ。しかし今日、そのリズムは微妙に狂っていた。

検査班長が汗にまみれた作業服で駆け寄ってきた。彼の手には、不完全に成形されたプラスチックケース、通称「**ショートショット（Short Shot）**」の不良品が握られていた。

「朝から様子がおかしいんです。端まで材料が詰まりきらない。もう何度目か分かりません」

「**ショートショット（Short Shot）**」。溶融したプラスチックが金型の端まで到達せずに固まってしまう未充填不良。現場のエンジニアたちは、この不良を「幽霊」と呼ぶ。原因があまりにも多様だからだ。

班長は油のついた手袋を脱ぎながら尋ねる。「バレルの温度が低いんですか、それとも射出圧力が足りないんですか？ ヒーターから分解しましょうか？」

現場では通常、「勘（Gut Feeling）」で決定される。「今日は寒いから温度の問題だろう」。そしてその勘が外れれば、数百万ウォンの金型修正費用が露と消える。

私は首を振った。「いいえ、まだです。まだ確信は持てません。もう少し確認してみましょう」

私は真っ白なノートを手に取った。私の武器である「**ベイズ推論（Bayesian Inference）**」を取り出したのだ。ベイズ数学とは、冷徹なデータを通じて熱い真実を探求する過程、すなわち「**ベイズ更新（Bayesian Update）**」の記録である。

私はしばし容疑者を追い詰め、犯人を捜し出す刑事（Detective）になることにした。犯人は工場の中にいる。私の頭の中には即座に二人の容疑者（Suspect）が浮かんだ。

### 容疑者 (Suspect)

- **容疑者 A：温度 ($H_T$)**
  - 性格：気まぐれ。バレルの温度が低かったり、ハンチング（Hunting）が発生したりすると、樹脂が固まって端まで流れない。不安定な充填によるショートショット不良を引き起こす。
  - 特異点：こいつが犯人なら、不良率は8% ($p = 0.08$) まで跳ね上がる。

- **容疑者 B：圧力 ($H_P$)**
  - 性格：気が小さく力が足りない。こいつは保圧が弱くて、たまに最後まで材料を押し込めない問題がある。
  - 特異点：こいつが原因なら、比較的おとなしくて不良率は4% ($p = 0.04$) 程度だ。

## 経験的な直感と疑念、事前知識（Prior：事前確率）

犯人はこの二人のうちのどちらかだ。しかし、むやみに機械を止めてヒーターを分解するわけにはいかない。MES（製造実行システム）の前期の記録を見ると、ショートショット事故の60%は「温度」の仕業だった。

「過去の前科記録を見ると、今回も温度の可能性が高そうだ」

私の中に**事前信念（Prior Belief）**がセットされる。私はデータをノートに記録し始めた。

- **事前確率 (Prior)**
  - 温度である確率 P($H_T$) : 60% (有力な容疑者)
  - 圧力である確率 P($H_P$) : 40%

プロは確率よりも**オッズ (Odds)**を好んで使う。

$$
\text{Prior Odds} = \frac{0.6}{0.4} = \mathbf{1.5}
$$

（解釈：現在、私は温度が犯人であるという方に、圧力よりも1.5倍多く賭けている状態だ）

## 第一の証拠：午前の襲撃 (Update 1)

「班長、今生産されたものを50個だけ無作為に検査してみましょう」

午前10時、最初の証拠品（$D_1$）が机の上にぶちまけられた。50個のサンプルのうち、5個がショートショットだった。($n = 50, k = 5$)

「50個中5個か……不良率10%？」

一瞬、背筋が凍った。圧力の問題 ($p = 0.04$) なら、50個中せいぜい2個程度出るのが正常だ。こいつの仕業にしては過激すぎる。5個は多すぎる。むしろ乱暴な「温度」（不良率8%）の署名（Signature）に近い。

ここでベイズの核心的な武器である**尤度（Likelihood）**が登場する。「どちらが犯人である場合に、この証拠（5/50）がより説明がつくか？」

私は素早く**ベイズ因子（Bayes Factor）**、すなわち「証拠の重み」を計算した。

$$
\text{Bayes Factor} = \frac{P(D|H_T)}{P(D|H_P)}
$$

$$
\approx \left(\frac{0.08}{0.04}\right)^5 \times \left(\frac{0.92}{0.96}\right)^{45}
$$

$$
= 2^5 \times (0.9583)^{45}
$$

$$
= 32 \times 0.147
$$

$$
\approx \mathbf{4.7}
$$

**4.7倍**。

このデータ（50個中5個の不良）は、圧力よりも**温度の仮説を4.7倍も強力に支持している**。

今こそ信念を更新（Update）すべき時だ。「元の信念 (1.5)」に「証拠の力 (4.7)」を掛ける。

ベイズ更新 (Posterior 1)：確信の急上昇

既存のオッズ (1.5) に証拠 (4.7) が結合される。

$$
\text{New Odds} = 1.5 \times 4.7 = \mathbf{7.05}
$$

これを確率に換算すると：

$$
P(H_T|D_1) = \frac{7.05}{1+7.05} \approx \mathbf{87.6\%}
$$

新たな確信：温度が犯人である確率が 60% → 87.6% に暴騰した。データが「犯人は温度だ！」と叫んでいる。

「ヒーターの問題である確率が90%近くになります！ 班長、メンテナンスチームを待機させてください。バレルの温度チェックに入ります！」 私の声は確信に満ちていた。勝利感に酔いしれながらコーヒーを一口飲んだ。

## 第二の証拠：ベイズの反撃 (Update 2)

このシナリオのハイライトはここからだ。多くの人がベイズを「一度計算して終わり」のものだと勘違いしている。しかし、ベイズの真の力は**累積（Update Loop）**にある。

午後2時。メンテナンスチームが到着する直前、班長が妙な表情で二度目のサンプル（D2）を持ってきた。「昼休みの後、もう50個取ってみたんですが……おかしいんです」

**【合計50個中、不良1個発生】**

「何？ 1個だと？」 私の確信にヒビが入る音が聞こえた。もし本当に犯人が乱暴な「温度」（通常8%）なら、50個中1個（2%）は少なすぎる。むしろこれは、おとなしい「圧力」（通常4%）がやりそうなことだ。

データが叫んでいる。「犯人は温度ではないかもしれない！」

さあ、ベイズ推論の魔法が始まる。先ほど持っていた **87.6%の確信（Posterior）**。それは消え去るのではない。それは午後の推論のための **新たな出発点（New Prior）** となる。

**【午前の結論＝午後の開始】** これこそが人工知能が、そして私たちが世界を学ぶ方法だ。私は再び計算を始めた。午前の計算結果（事後確率）を今回の計算の事前確率としてアップデートし、データ（D2）の証拠能力を検証する。

$$
\text{Bayes Factor}_2 \approx \left(\frac{0.08}{0.04}\right)^1 \times \left(\frac{0.92}{0.96}\right)^{49}
$$

$$
= 2 \times 0.122
$$

$$
\approx \mathbf{0.244}
$$

値が1よりずっと小さい。これは「温度の仮説に不利な証拠」であることを意味する。正確に言えば、第二の証拠は圧力の仮説を約4倍支持している。凄まじい反証だ。午前の確信が崩れ落ちる音がした。

## ベイズ二次更新 (Posterior 2)：ベイズの審判、謙虚になる確信

今度は「午前の確信（オッズ 7.05）」に「午後の反転（0.244）」を掛ける。

$$
\text{Final Odds} = 7.05 \times 0.244 \approx \mathbf{1.72}
$$

確率に換算すると：

$$
P(H_T | D_1, D_2) = \frac{1.72}{1+1.72} \approx \mathbf{63.2\%}
$$

---

## 真実は収束する

頭の中の確率グラフが激しく揺れ動いた。私は急いでメンテナンスチームへの呼び出しを止めた。

「ちょっと待ってください。待機です。まだヒーターを分解しないでください」

私は汗を拭きながら椅子に寄りかかった。午前中は87%確信していたが、今は63%まで一気に落ちた。相変わらず温度は疑わしいが、「圧力」である可能性も36%まで息を吹き返した。もし先ほど興奮してヒーターを分解していたら、正常なヒーターを交換しただけで、本当の原因かもしれない圧力の問題を見逃していたところだった。工場は最も重要な時間を無駄にし、無駄金も使うところだった。

「班長、次のロットでサンプルをもう50個だけ取りましょう。データがもう一つあれば……確実に突き止められます」

データが積み重なれば、霧は晴れ、真実が姿を現す。真実はデータが積み重なるほど収束していく。それがベイズが私たちに教えてくれたやり方だ。

私は再び機械の鼓動に耳を澄ませた。私たちは安易に「犯人はお前だ！」とは叫ばない。ただ、絶え間なく入ってくるデータを見つめ、「**最も真実に近い確率**」へとアップデートし続けるだけだ。

---

## このシナリオの核心的なインサイト

1. **直感の数値化**：「温度の問題じゃないか？」という勘を P(H)=0.6 という数字に変えた瞬間、管理が可能になります。0.6がその瞬間の真実でなくても構いません。データが蓄積され更新され続けることで、モデルは自ら学習します。結局は真実へと収束していくからです。

2. **データの重み (LLR)**：5/50 の不良は強力な証拠 (+1.55) でしたが、二度目の 1/50 の良好な結果はそれと同じくらい強力な反証 (-1.39) となり、均衡を保ちます。

3. **動的な意思決定**：ベイズ的な観点は固定された結論ではありません。「今ある情報ではここまで分かっている」という謙虚で柔軟な姿勢が、エンジニアを過ちから救い出します。
   <br />

---

## 【ガイド】 [数学解説集] ()、Pythonコード付録

この緊迫した捜査劇の中で、私たちはすでにベイズ統計の核心的な4つのステップを経験しました。

1. **事前確率 (Prior)**：「過去を見ると、あいつが犯人っぽいな」（初期の信念）

2. **尤度 (Likelihood)**：「現場の証拠があいつのスタイルにぴったりだ！」（証拠の適合性）

3. **ベイズ因子 (Bayes Factor)**：「この証拠はAよりもBを何倍支持しているか？」（証拠の重み）

4. **事後確率 (Posterior)**：「証拠を反映して信念を修正しよう」（最終的な結論）

そして最も重要なこと。**今日の事後確率は、明日の事前確率になる**。これこそが**学習 (Learning) の本質**です。

- **数学**：この物語は単なるエピソードではありません。徹底した数学的計算の上に築かれた城です。教科書で学ぶ「伝統的なベイズの定理」が、現場で使われる「オッズとベイズ因子」にどのように変換されるのか、その数学的な設計図（Blueprint）を別個の付録記事で公開します。

- **Pythonコード**：本文のシナリオをそのままPythonコード化した別の付録記事を参照できます。
  <br />
  <br />
